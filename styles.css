/* --- BASE --- */
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #36393f;
    color: #dcddde;
    height: 100vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* --- TITLEBAR --- */
#titlebar {
    height: 25px;
    background-color: #202225;
    display: flex;
    justify-content: space-between;
    align-items: center;
    -webkit-app-region: drag;
    padding-left: 10px;
    font-size: 12px;
    font-weight: bold;
    color: #72767d;
    flex-shrink: 0;
}
#window-controls { -webkit-app-region: no-drag; display: flex; }
.control-btn { width: 28px; height: 25px; border: none; background: transparent; color: #dcddde; cursor: pointer; }
.control-btn:hover { background-color: #40444b; }
#close-btn:hover { background-color: #ed4245; }

/* --- LAYOUT --- */
.app-container { display: flex; flex: 1; overflow: hidden; }
.sidebar { width: 250px; background-color: #2f3136; display: flex; flex-direction: column; padding: 10px; }

/* LOGO STYLE */
.logo-container { padding: 10px 0 20px 0; text-align: center; border-bottom: 1px solid #202225; margin-bottom: 20px; }
.sidebar-logo { max-width: 180px; height: auto; display: block; margin: 0 auto; }

.sidebar-header { color: #8e9297; font-weight: bold; margin-bottom: 10px; text-align: center; text-transform: uppercase; font-size: 12px; }

/* MENU ITEMS & DRAWER ANIMATION */
.menu-item { padding: 10px; margin-bottom: 5px; border-radius: 4px; color: #96989d; cursor: pointer; font-weight: 500; display: flex; align-items: center; }
.menu-item:hover { background-color: #393c43; color: #dcddde; }
.menu-item.active { background-color: #393c43; color: #fff; border-left: 4px solid #5865f2; }
.menu-item i { width: 25px; }

/* Undermeny (Drawer) */
.submenu-container {
    overflow: hidden;
    max-height: 0;
    transition: max-height 0.3s ease-out;
    padding-left: 15px; /* Indrykk for undermeny */
}
.submenu-container.open {
    max-height: 200px; /* Nok til å vise elementene */
}
.submenu-item {
    padding: 8px 10px;
    font-size: 13px;
    color: #8e9297;
    cursor: pointer;
    border-radius: 4px;
    margin-bottom: 2px;
}
.submenu-item:hover { background-color: #393c43; color: white; }
.submenu-item.active { color: #fff; background-color: #40444b; }
.menu-chevron { margin-left: auto; transition: transform 0.3s; font-size: 10px;}
.menu-open .menu-chevron { transform: rotate(90deg); }


/* Main Content */
.main-content { flex: 1; background-color: #36393f; padding: 20px; overflow-y: auto; position: relative; }
.view-section { display: none; }
.view-section.active { display: block; }

/* --- EDITOR --- */
.editor-grid { 
    display: grid; 
    grid-template-columns: 90px 1fr 2fr 2fr; 
    gap: 15px; 
    align-items: start;
}
.col-header { font-weight: bold; text-transform: uppercase; font-size: 12px; margin-bottom: 10px; padding-bottom: 5px; border-bottom: 2px solid; }
.col-uke { border-color: #5865f2; color: #5865f2; }
.col-tema { border-color: #faa61a; color: #faa61a; }
.col-akt { border-color: #3ba55c; color: #3ba55c; }
.col-krav { border-color: #e67e22; color: #e67e22; }

/* Inputs & Textareas */
input, textarea, select {
    background-color: #40444b;
    border: none;
    color: #dcddde;
    padding: 10px;
    border-radius: 4px;
    width: 100%;
    margin-bottom: 10px;
    font-family: inherit;
}
input:focus, textarea:focus { outline: 2px solid #5865f2; color: white; }

#tema-input { height: 150px; resize: none; }

.col-uke-content {
    background: #40444b;
    border-radius: 4px;
    height: 150px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
}
#uke-display { font-size: 32px; color: white; margin: 0; line-height: 1.2; }
#uke-label { color: #888; font-size: 10px; margin-top: 5px; text-transform: uppercase; letter-spacing: 1px; }

.week-navigator { display: flex; justify-content: space-between; align-items: center; width: 100%; padding: 0 5px; margin-bottom: 5px; }
.week-nav-btn { cursor: pointer; color: #72767d; font-size: 12px; padding: 5px; transition: color 0.2s; }
.week-nav-btn:hover { color: white; }

/* Quill Editor Fix */
.ql-container { 
    background-color: #40444b; 
    color: #dcddde; 
    border: none !important; 
    border-radius: 0 0 4px 4px; 
    font-family: 'Segoe UI', sans-serif; 
    font-size: 15px; 
    height: 400px;
    display: flex;
    flex-direction: column;
}
.ql-editor { 
    height: 100%;       
    overflow-y: auto;   
    padding: 15px;
    -webkit-user-modify: read-write-plaintext-only; 
    outline: none;
}
.ql-toolbar { background-color: #2f3136; border: none !important; border-radius: 4px 4px 0 0; color: #dcddde; }
.ql-stroke { stroke: #dcddde !important; }
.ql-fill { fill: #dcddde !important; }
.ql-picker { color: #dcddde !important; }

.custom-emoji-select {
    background-color: #2f3136;
    color: #dcddde;
    border: 1px solid #202225;
    border-radius: 4px;
    padding: 2px 5px;
    margin-left: 5px;
    height: 24px;
    font-size: 14px;
    cursor: pointer;
    outline: none;
}
.custom-emoji-select:hover { background-color: #40444b; }

/* --- PREVIEW & SEARCH RESULTS (KOMPAKT VERSJON) --- */
.preview-card { 
    background: #ffffff; 
    color: #000000; 
    padding: 0; 
    box-shadow: 0 4px 6px rgba(0,0,0,0.3); 
    width: 100%; 
    font-family: 'Segoe UI', sans-serif; 
    margin-bottom: 20px; 
    font-size: 13px; /* Generelt mindre tekst */
}

/* Mindre header */
.preview-header { 
    background-color: #2f3136; 
    color: white; 
    padding: 8px 15px; /* Mindre luft */
    display: flex; 
    justify-content: space-between; 
    align-items: center; 
    font-weight: bold; 
    font-size: 1.2em; /* Mindre overskrift */
    border-bottom: 3px solid #5865f2; 
}

.preview-grid { 
    display: grid; 
    grid-template-columns: 1fr 2fr 1.5fr; 
    background-color: #ffffff; 
}

/* Mer kompakt innhold */
.preview-section { 
    padding: 10px 12px; /* Mindre luft rundt teksten */
    border-right: 1px solid #e0e0e0; 
    background-color: #ffffff; 
}
.preview-section:last-child { border-right: none; }

.preview-h { 
    text-transform: uppercase; 
    font-size: 0.85em; /* Mindre overskrift på kolonnene */
    font-weight: 800; 
    margin-bottom: 6px; 
    padding-bottom: 3px; 
    border-bottom: 1px solid #eee; 
    display: block; 
    letter-spacing: 0.5px; 
}

/* VIKTIG: white-space: pre-wrap sørger for at linjeskift i Tema vises */
.preview-section p, .preview-section div {
    margin: 0;
    line-height: 1.3;
    white-space: pre-wrap; 
}

/* --- TIDSLINJE --- */
.timeline-list { display: flex; flex-direction: column; gap: 8px; }
.timeline-item {
    background: #2f3136; padding: 12px 15px; border-radius: 6px; cursor: pointer; display: flex; align-items: center;
    border-left: 4px solid #2f3136; transition: 0.2s;
}
.timeline-item:hover { background: #393c43; border-left-color: #5865f2; }
.timeline-info { font-size: 1.1em; font-weight: bold; color: #fff; width: 140px; flex-shrink: 0; }
.timeline-tema { color: #dcddde; flex: 1; font-size: 0.95em; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

/* --- MODAL (POPUP) - STRAMMET DESIGN --- */
.modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); }
.modal-content { 
    background-color: #2f3136; 
    margin: 0 auto; 
    padding: 20px; 
    border: 1px solid #202225; 
    border-radius: 8px; 
    width: 90%; 
    max-width: 1100px; 
    box-shadow: 0 5px 15px rgba(0,0,0,0.5); 
    position: relative; 
    top: 50%; 
    transform: translateY(-50%); 
}
.close-modal { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; }
.close-modal:hover { color: white; }

.prev-week-grid {
    display: grid;
    grid-template-columns: 1fr 2fr 1.5fr; /* Samme ratio som preview */
    gap: 0;
    border: 1px solid #202225;
    background-color: #2f3136;
    margin-top: 15px;
    align-items: stretch; /* Sørg for at border går hele veien */
}

.prev-col {
    padding: 0; /* VIKTIG: Nullstiller padding her for å fjerne 'hull' */
    border-right: 1px solid #202225;
    color: #dcddde;
    max-height: 500px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
}
.prev-col:last-child { border-right: none; }

/* Header i popup - ligger helt øverst nå */
.prev-header {
    font-weight: 800;
    text-transform: uppercase;
    font-size: 0.8em;
    padding: 10px 12px 6px 12px; /* Top/Side padding */
    margin: 0;
    border-bottom: 2px solid; 
    letter-spacing: 0.5px;
    background-color: #2f3136; /* Sikrer at den dekker bakgrunnen */
    position: sticky; /* Holder den øverst hvis man scroller (valgfritt) */
    top: 0;
}

/* Innholdet under headeren */
.prev-content {
    padding: 6px 12px 12px 12px; /* Padding for teksten */
    white-space: pre-wrap; /* Viser linjeskift */
    line-height: 1.4;
    font-size: 14px;
}


/* --- BUTTONS & SETTINGS --- */
.day-selector { display: flex; gap: 5px; flex-wrap: wrap; margin-bottom: 10px; }
.day-toggle { background-color: #40444b; border: 1px solid #202225; color: #96989d; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; user-select: none; }
.day-toggle.selected { background-color: #5865f2; color: white; border-color: #5865f2; }
.day-toggle.selected-homework { background-color: #e67e22; color: white; border-color: #e67e22; }

.btn { padding: 8px 16px; border-radius: 4px; border: none; cursor: pointer; font-weight: bold; color: white; transition: 0.2s; }
.btn-primary { background-color: #5865f2; }
.btn-primary:hover { background-color: #4752c4; }
.btn-secondary { background-color: #4f545c; }
.btn-secondary:hover { background-color: #5d6269; }
.btn-danger { background-color: #e74c3c; }
.btn-success { background-color: #3ba55c; }
.btn-warning { background-color: #e67e22; color: white; }
.btn-small { padding: 4px 8px; font-size: 12px; margin-right: 5px; margin-bottom: 5px; }

.settings-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
.settings-table th, .settings-table td { text-align: left; border-bottom: 1px solid #4f545c; padding: 10px; font-size: 14px; }

::-webkit-scrollbar { width: 10px; height: 10px; }
::-webkit-scrollbar-track { background: #2f3136; }
::-webkit-scrollbar-thumb { background: #202225; border-radius: 5px; }